# Отчет по проделанной работе (19/04/2023)

## Обучение `Guesser`

[train_guesser.py](../src/train_guesser.py)

**Здесь и далее рассматривается режим с $K = 5$ дикторами и $T = 3$ запрашиваемыми словами, если не указано обратное.**

Единственное отличие самой модели от статьи -- увеличенная размерность
эмбеддингов (со 128 до 512). Производилась оптимизация гиперпараметров `lr`,
`batch_size` и `weight_decay`. Полученные значения здесь и далее используются в
качестве параметров по умолчанию.

Результаты для различных `seed`. В данном случае в каждом эксперименте деление
`train-val` также было различным (`test` зафиксирован создателями датасета).

![guesser loss and accuracy on train](./images/v02_guesser_train.png)
![guesser loss and accuracy on val](./images/v02_guesser_val.png)

| seed  | test_acc |
|:-----:|:--------:|
| 23894 | 0.933    |
| 3829  | 0.939    |
| 89349 | 0.933    |
| 12389 | 0.933    |
| 23489 | 0.933    |

При указанном по умолчанию `seed` точность на тестовой выборке составила 0.936.


## Обучение `Enquirer`

[train_enquirer.py](../src/train_enquirer.py)

Используются `Guesser`, обученный при дефолтных гиперпараметрах / `seed`,
деление `train-val` также неизменно (`--split-seed=42`). Также, как и для
`Guesser` было проверено влияние `lr` и `batch_size`, но тут есть ещё
пространство для экспериментов.

Кривые зависимостей средней награды (точности) от числа эпизодов:

![enquirer avg. reward on train](./images/v02_enquirer_train.png)
![enquirer avg. reward on val](./images/v02_enquirer_val.png)

| seed  | test_acc |
|:-----:|:--------:|
| 23894 | 0.984    |
| 3829  | 0.982    |
| 89349 | 0.977    |
| 12389 | 0.985    |
| 23489 | 0.983    |


Важный момент: при обучении и тестировании выходы `Enquirer` (вероятности) используются по-разному:
* `.train()` -- сэмплирование из распределения,
* `.eval()` -- `argmax` среди не запрошенных ранее слов.
Добавление запрета на повторный выбор слова позволило увеличить точность на ~1%.


## Эвристические агенты

...